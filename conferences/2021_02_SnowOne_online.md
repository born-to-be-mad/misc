### Jean-Philippe Bempel ‚Äì Production profiling with JDK Flight Recorder & JDK Mission Control
Links: 
* https://github.com/thegreystone/java-svc/tree/master/jfr
* https://github.com/thegreystone/jmc-jshell/
* https://github.com/thegreystone/jmc-tutorial/
* https://github.com/brendangregg/FlameGraph/

*Rate*: üåü :star2:

### Otavio Santana ‚Äì Framewars: the battle between NoSQL and Java in the cloud arena
*Rate*: üò™ :sleepy:
*Feedback:* an intro to different nosql and graph DB tools and frameworks. 

### Martin Toshev ‚Äì Elasticsearch integrations
*Rate*: :star2:
*Feedback:* a good description of elasticsearch integration with a lot of codes inc. own plug-in 

### –ò–≤–∞–Ω –ü–æ–Ω–æ–º–∞—Ä—ë–≤ ‚Äì LJV: –ß–µ–º—É –Ω–∞—Å –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö –≤ Java
*Links*: https://github.com/atp-mipt/ljv
*Rate*: üåü :star2: üî• :fire: üíó :heartpulse: üí™ :muscle: üîÅ :repeat:
*Feedback:* –≤–Ω–µ—à–Ω–µ –ø—Ä–æ—Å—Ç–∞—è –∏–¥–µ—è, –Ω–æ –Ω–∞—Å–∫–æ–ª—å–∫–æ —à–∏–∫–∞—Ä–Ω–æ –∏ –ª–µ–≥–∫–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–µ–ª–µ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π

### –Æ—Ä–∏–π –ë–∞–¥–∞–ª—å—è–Ω—Ü ‚Äì Production-ready functional programming
*Rate*: üåü :star2: üî• :fire: üí™ :muscle:
*Feedback:* –ø—Ä–∏–º–µ—Ä –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—É–ª–∞ —Å –ø–æ–ª–Ω–æ–π –º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ Scala

### –ê–ª–µ–∫—Å–µ–π –ò–≥–Ω–∞—Ç–µ–Ω–∫–æ ‚Äì –ü–æ—á–µ–º—É Java Enterprise –±–µ–Ω—á–º–∞—Ä–∫–∏ –≤—Ä—É—Ç, –∏ —á—Ç–æ —Å —ç—Ç–∏–º –¥–µ–ª–∞—Ç—å
*Links*: some benchmarks for JVM 11 
  * https://github.com/chrisgleissner/benchmarks
   * fork with fixes https://github.com/KryukovaLidiya/benchmarks
*Rate*: üåü :star2: üî• :fire:
*Feedback:* –¥–ª—è —á–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å enterprise –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∫–∞–∫, enterprise benchmarks –∏ –Ω–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ TUSLA

### –ê–ª–µ–∫—Å–µ–π –®–∏–ø–µ–ª–µ–≤ - "Java-–æ–±—ä–µ–∫—Ç—ã –Ω–∞–∏–∑–Ω–∞–Ω–∫—É"
*Rate*: üåü :star2: üî• :fire:
–°—Å—ã–ª–æ—á–∫–∏ –ø—Ä–æ "Java-–æ–±—ä–µ–∫—Ç—ã –Ω–∞–∏–∑–Ω–∞–Ω–∫—É":
- —Å–ª–∞–π–¥—ã: https://shipilev.net/talks/snowone-Feb2021-javaobjec...
- –ø–æ—Å—Ç: https://shipilev.net/jvm/objects-inside-out/

### –ë–∞—Ä—É—Ö –°–∞–¥–æ–≥—É—Ä—Å–∫–∏–π - –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–æ–¥–∞—Ç—å —Å–µ–±—è —Ä–∞–¥–∏ —Ñ–∞–Ω–∞ –∏ –ø—Ä–æ—Ñ–∏—Ç–∞
*Rate*: üåü :star2: üî• :fire: üí™ :muscle: üîÅ :repeat:
*Links*:
* —Ç–µ—Å—Ç –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å https://www.16personalities.com/ru/test-lichnosti
* –ø–æ–¥–∫–∞—Å—Ç https://newpodcast2.live/
* –ö–Ω–∏–≥–∏:*
* –≠—Ä–∏–Ω –ú–µ–π–µ—Ä "–ö–∞—Ä—Ç–∞ –∫—É–ª—å—Ç—É—Ä–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π. –ö–∞–∫ –ª—é–¥–∏ –¥—É–º–∞—é—Ç, —Ä—É–∫–æ–≤–æ–¥—è—Ç –∏ –¥–æ–±–∏–≤–∞—é—Ç—Å—è —Ü–µ–ª–µ–π –≤ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π —Å—Ä–µ–¥–µ" 
* Kim Scott "Radical Candor: Fully Revised & Updated Edition: Be a Kick-Ass Boss Without Losing Your Humanity" 

### Work shop '–£—á–∏–º—Å—è –≥–æ—Ç–æ–≤–∏—Ç—å Spark'
*Links*:
* Quick prototyping with zeppelin - see :https://zeppelin.apache.org/docs/0.8.0/quickstart/install.html
* real Spark project https://github.com/asm0dey/gradle-spark-quickstart
*Rate*: üåü :star2: üî• :fire: üíó :heartpulse: üí™ :muscle: üîÅ :repeat:
*Requirements:*
* Intellij Idea Ultimate
* Idea plug-ins: 'Big Data Tools', 'Scala'
* Activate a checkbox "Enable ZTools integration" in "Zeppelin Connection" settings 
*Feedback:* –±—ã—Å—Ç—Ä–∞—è –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å Spark
* Examples:
```
import org.apache.spark.sql.types.IntegerType

val df = spark.read
.option("header", true)
.option("inferSchema", true)
.csv("/home/dma/projects/hadoop-workshop/ml-latest/movies.csv")
.cache()

%

df
.filter($"title" rlike (""""?.*\(\d{4}\)\s*"?"""))
.withColumn("year", regexp_extract($"title", """\((\d{4})\)\s*"?""", 1).cast(IntegerType))
.withColumn("title", regexp_replace($"title", """\(\d{4}\)\s*"?""", ""))
.groupBy($"year")
.agg(count($"title"), $"year")
.createOrReplaceTempView("countOfMovies")


%spark.sql

SELECT `count(title)` as cnt, year
FROM countofmovies
WHERE year BETWEEN 1910 and 2016
ORDER BY year
%spark
import org.apache.spark.sql.types.{IntegerType, StringType}

case class Movie(movieId: Long, title: String, genres: String)

case class MovieWithYear(movieId: Long, title: String, genres: String, year: Integer)

case class MovieWithGenresAndYear(movieId: Long, title: String, genres: Array[String], year: Integer)

case class MovieWithSingleGenre(movieId: Long, title: String, genre: String, year: Integer)

case class MovieExploded(movieId: Long, title: String, genres: Array[String])

case class MovieAggregate(year: Int, count: Long)

import spark.implicits._ 

val source = spark.read
.option("header", true)
.option("inferSchema", true)
.csv("/home/dma/projects/hadoop-workshop/ml-latest/movies.csv")
.as[Movie]
.filter(_.title.matches("""^"?.*\(\d{4}\)\s*"?$"""))
.map(m => {
val lastOpen = m.title.lastIndexOf("(")
val year = m.title.substring(lastOpen + 1, lastOpen + 5).toInt
MovieWithYear(m.movieId, m.title.replaceAll("""\(\d{4}\)\s*"?$""", ""), m.genres, year)
})
.map(m => MovieWithGenresAndYear(m.movieId, m.title, m.genres.split("\\|"), m.year))
.flatMap(m => m.genres.map(g => MovieWithSingleGenre(m.movieId, m.title, g, m.year)))
.filter(_.genre != "(no genres listed)") 

%
source
.groupByKey(_.year)
.mapGroups((k, v) => (k, v.size))
.orderBy("_1")
.show() 

%spark
case class Rating(userId: Long, movieId: Long, rating: Double, timestamp: Long)

%spark
val ratings = spark.read
        .option("header", true)
.option("inferSchema", true)
.csv("/home/dma/projects/hadoop-workshop/ml-latest/ratings.csv")
.as[Rating]
.limit(10)
%spark

source.joinWith(ratings, source.col("movieId") === ratings.col("movieId"), "left")
        .filter(_._2 != null)
        .map {
            case (a, b) =>
                (a.title, b.rating)
        }
        .distinct()
        .limit(1)

%

```

### Victor Rentea ‚Äì Integration Testing with Spring

*Rate*: üåü :star2: üî• :fire: üí™ :muscle: üîÅ :repeat:

*Links*:
* https://github.com/victorrentea/integration-testing-spring
# Integration Tests

*Characteristics*: deep, slow, fragile/flaky
*Where*: files, databases, queues

## Test Execution

* using test profiles, f.e. H2 database with active 'ps6spy' to proxy all jdbc calls
  @ActiveProfiles("db-mem") with the separate file 'application-db-mem.properties/application-db-mem.yml'
  @ActiveProfiles("db-h2") with the separate file 'application-db-h2.properties/application-db-h2.yml'
```properties
#spring.datasource.url=jdbc:h2:tc[://localhost:9082/~/test
#driver-class-name=orh.h2.Driver
spring.datasource.url=jdbc:p6spy:h2:tc[://localhost:9082/~/test
driver-class-name=com.ps6spy.engine.spy.P6SpyDriver
spring.datasource.username=sa
spring.datasource.password=sa
spring.jpa.hibernate.ddl-auto=create
```

* CleanupBeforeTest for some cases

* clear all necessary table by executing scripts from test resources
```java
@Sql(scripts = "classpath:/clear-data.sql", executionPhase = ExecutionPhase.BEFORE_EACH)
```

* re-create the context for every test - to avoid interference between tests, but performance is slower
```java
@DirtyContext(classMode = ClassMode.BEAFORE_EACH_TEST_METHOD)
```

* use @Transactional on the test to run each test in a Transactional
```java
@SpringBootTest
@ActiveProfiles("db-h2")
@Transactional
```

* use Assertions in @BeforeEach method to be sure that system in correct state,
  ```xml
  <dependency>
    <groupId>org.assertj</groupId>
    <artifactId>assertj-code</artifactId>
  </dependency>
  ```
  it is useful for real-world projects, f.e. nested transactions
```java
    @BeforeEach
    public final void before() {
        assertThat(repo.findAll()).isEmpty();
        asssertTha(scoreStr).isEqualTo("Test");
        //collections
        asssertTha(list).anyMatch(e -> e.getX() == 1);
        asssertTha(list).doesNotContain(2);
    }
```

* useful arguments to run tests and speed up them dramatically
  `-ea -noverify -mx2048m -Xverify:none -XX:TieredStopAtLevel=1`

* dockerize dependencies in case of DB specific features when you can't use H2 and real DB is needed,
  then use specific @Tag and use docker and separate mvn/gradle task which start docker container with DB
```java
@Tag("integration")
@ContextConfiguration(initializers = WaitForDatabase.class)
@SpringBootTest
```

* use @MockBean which overrides the @Bean with mock functionality


## Test Data

* create base class RepoTestBase(junit 4), it can also hold all useful annotations @SpringBootTest, @Transactional, @ActiveProfile
```java
public abstract class RepoTestBase{
    @BeforeEach
    public final void populateSomeData() {
    }
}
```

* use extensions form Junit5
```java
public class CommonDataExtension implements BeforeEachCallback{
    @Override
    public final void beforeEach(ExecutionContext context) throws Exception {
        //save test data
    }
}

public class ClassUnderTest {
    //use extension in target class
    @RegisterExtension
    public CommonDataExtension data = new CommonDataExtension();
}
```

* insert via @Profile - a Spring bean persisting data at app startup

* use @Sql to populate data from test resources
* `@Sql` =  TestClass.testMethod.sql
* `@Sql("data.sql)`
* `@Sql({"schema.sql", "data.sql"})`


## Integration in Action

* Cucumber and Spring Integration via Gherkin Language

* override properties, WireMockExtension and mappings
```java
@SpringBootTest(properties = "safety.service.url.base=http://localhost:8099")

@RegisterExtension
public WireMockExtension wireMock = new WireMockExtension(8099);
// it really starts the http server which  listens to the mocked port and responds with some data
```
+ files 'resources\mappings\urlName-SAFE.json' and 'resources\mappings\urlName-UNSAFE.json'containing "request" and "Response"

* wiremock recordings
  `java -jar wiremock-standalone-2.27.2.jar` to start the server and record http calls
    * go to http://wiremock.org/docs/running-standalone/
    * download
    * run
    * go to http://localhost:8080/__admin/recorder
    * start recording
    * point yur app/test to localhost:8080 (wiremock proxy)

### –ê–ª–µ–∫—Å–µ–π –ù–µ—Å—Ç–µ—Ä–æ–≤ - Spring Cloud –≤ —ç—Ä—É Kubernetes

*Rate*: üåü :star2: üî• :fire: üí™ :muscle: üîÅ :repeat:

*Feedback:* –∂–∏–∑–Ω—å –¥–æ –∏ –ø–æ—Å–ª–µ –∫—É–±–µ—Ä–Ω–µ—Ç–∏—Å, `Spring Cloud` –≤ –ø–æ–º–æ—â—å
* use `Kubernetes` –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –æ—Ç —è–∑—ã–∫–∞ –∏ —Å—Ç–µ–∫–∞ –±–∞–∑–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
* use `Spring Cloud` –¥–ª—è —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

| Goal | Tools | Netflix | Spring Cloud | Kubernetes(K8s + Istio) |
| --- | --- | --- | --- | --- |
| Discovery | Service Discovery | Eureka | Eureka(or Consul/etcd/zookeeper) + Spring Cloud Discovery Client | K8S DNS |
| Fault tolerance | Circuit Breakers | Hystrix| Spring Cloud Circuit Breaker(Resilence4j, Hystrix ) | services + liveness / readiness |
| Resilience | Load Balancing | Ribbon(client-side load balancing) | Spring Cloud Load Balancer | Istio 'service mesh' |
| Configuration | Configuration | Archaius | Spring Cloud Config Server/Client | ConfigMap +  Secrets  |
| API management  | API gateways  | Zuul | Spring Cloud Gateway | Istio 'service mesh' |

Spring Cloud extra features:
* Tracing: Sleuth
* Event-based microservice: Spring CLud Stream
* Consumer Driven Contracts: Spring Cloud Contract
* FaaS:Spring Cloud Function
* REST clients: OpenFeign

Spring Cloud Integrations: 
* AWS
* Azure
* Google CLoud
* CloudFoundry
* Kubernetes


*Links*:
* https://github.com/alek-sys/spring-cloud-k8s-talk

# WATCH LATER

* –ú–∏—Ç—è –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤ ‚Äì Helidon ‚Äî –õ–∞—Å—Ç–æ—á–∫–∞ –≤ –º–∏—Ä–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
* What I Wish I Knew About Maven Years Ago
* –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –í–æ–ª–∏–≤–∞—á: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ
* Running Java Everywhere with GraalVM Native Image
* –û–ª–µ–≥ –ü–ª–∏—Å—Å ‚Äì –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ –Ω–∞—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –æ–±—Ä–∞–∑ –≤ –ø—Ä–æ–µ–∫—Ç–µ GraalVM
* Grace Jansen ‚Äì Reacting to an event-driven world
* –ï–≤–≥–µ–Ω–∏–π –ú–∞–Ω–¥—Ä–∏–∫–æ–≤ ‚Äì Scala, Kotlin, Java –∏ Code Coverage: –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ, —á—Ç–æ —Å–∫—Ä—ã—Ç–æ
* GraalVM: The one to rule them all

